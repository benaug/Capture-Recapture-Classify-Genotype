Capture-recapture-classify using genotypes for individual identity

Nonspatial application of the approach used in the genotype SPIM repo, with some differences. No spatial information is used (obviously), observation model is different (Poisson more realistic with space, less so without), and therefore the ID update is different. The observation model here is Bernoulli for detection then zero-truncated Poisson for number of samples given detection. I use a categorical sampler here instead of Metropolis-Hastings I used in genotype SPIM. I like this observation model better and should add it to genotype SPIM.

Currently there are files for M0 and Mh. Both do not consider variation in genotyping error probabilities as a function of covariates. These can be added in the same manner they are in the genotype SPIM repository. Note, you need "better data" for Mh as you do for regular capture-recapture. If individual heterogeneity is largely due to spatial juxtoposition of individuals and detectors, and you have the requisite spatial information recorded, perhaps try the genotype SPIM.

I have run 2 simulation scenarios and the estimates look great for those. In one scenario, I used 9 loci x 3 reps with an amplification probability of 0.9 (expected scores per sample of 9x3x0.9=24.3). This was sufficient genetic information that there was no uncertainty in how many individuals captured, n. All 100 sims converged to the correct value of n, though one took about 12,000 iterations to get there. In the second I used 4 loci x 3 reps with an amplification probability of 0.83 (expected scores per sample of 4x3x0.83=10). There was moderate uncertainty in the number of individuals captured in this scenario. The estimates of n were roughly unbiased with nominal coverage. Mixing was acceptable, but could likely be improved with a joint N/y.true update (analogous to z-ID update, but distributions are on N and y.true).

Another note: if the observed genotype data is very sparse and the false positive probabilities are initialized near 1, particularly for heterozygotes, it looks like it can get stuck there. The posterior is multimodal, but this mode is obviously the wrong one. In this case, initialize the genotyping error rates to realistic values or change the prior to reflect that false alleles are very rare.